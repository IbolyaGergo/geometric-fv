\documentclass[tikz,border=2pt]{standalone}

% Needed for standalone compilation of fig/*.tex
\IfFileExists{../preamble.tex}
{\input{../preamble.tex}}% If compiling *.tex directly
{\input{preamble.tex}}% If compiling main.tex

\IfFileExists{tikz-shapes.tex}
{\input{tikz-shapes.tex}}
{\input{fig/tikz-shapes.tex}}

\pagestyle{empty}

% Need to include babel, since in preamble I have
% \usepackage[slovak,english]{babel}, so symbols like '!','"' can become active,
% which confuses the calc library because it uses '!' for calculations.
\usetikzlibrary{calc,babel}

\begin{document}%
\begin{tikzpicture}[x=2cm,y=2cm]
    \DrawFVGrid
    \SetupLinear

    % Redefine u_{i+1} for better readability
    \def\hR{1.1*\hM}
    \coordinate (cR) at (1.5*\dx,\hR);

    % Draw the slope connecting u_i and u_{i+1}
    % Extending to x=0 (left of i) and x=2dx (right of i+1)
    \draw[red] ($(cM)!-0.5!(cR)$) --
        node[slope text,pos=.95,yshift=-1pt] {Lax-Wendroff}
        ($(cR)!-0.5!(cM)$);

    \draw[green] ($(cL)!-0.5!(cM)$) --
        node[slope text,pos=.95,yshift=-1pt] {Beam-Warming}
        ($(cM)!-0.5!(cL)$);

    \draw[blue] ($(cM) - 0.75*($(cR)-(cL)$)$) --
        node[slope text,very near end] {Fromm}
        ($(cM) + 0.75*($(cR)-(cL)$)$);

    \foreach \pos   \avg  \s    \idx in {
             -\dx / \hL / \sL / {i-1},
             0    / \hM / \sM / {i},  
             \dx  / \hR / \sR / {i+1} 
    } {
        \filldraw[avg dot] (\pos + 0.5*\dx, \avg) circle (\dotSize);
        \node[avg text] at (\pos+0.55*\dx, \avg - 0.2) {$u_\idx^n$};
    }

    \draw[help lines,dashed] (-\dx,0) --
        ($(cM) - 0.75*($(cR)-(cL)$)$);
    \draw[help lines,dashed] (0,0) --
        ($(cM)!-0.5!(cR)$);
    \draw[help lines,dashed] (\dx,0) --
        ($(cM)!-0.5!(cL)$);
    \draw[help lines,dashed] (2*\dx,0) --
        ($(cM) + 0.75*($(cR)-(cL)$)$);

\end{tikzpicture}
\end{document}
