\documentclass[tikz,border=2pt]{standalone}

% Needed for standalone compilation of fig/*.tex
\IfFileExists{../preamble.tex}
{\input{../preamble.tex}}% If compiling *.tex directly
{\input{preamble.tex}}% If compiling main.tex

\IfFileExists{tikz-shapes.tex}
{\input{tikz-shapes.tex}}
{\input{fig/tikz-shapes.tex}}

\pagestyle{empty}

\usetikzlibrary{calc,babel}

\begin{document}%
\begin{tikzpicture}[x=2cm,y=2cm]%
    \useasboundingbox (-1.8*\dx, -.2*\dx) rectangle (3*\dx, 1.7*\dx);%

    \DrawFVGrid
    \SetupAvgs

    % Draw
    \foreach \pos / \oldH / \newH / \idx in {
        -\dx / \hL / \hLn / {i-1},
         0   / \hM / \hMn / {i},
         \dx / \hR / \hRn / {i+1}
    } {

        \draw (\pos,0) -- ++(0, \oldH) -- +(\dx,0);%
        \DrawAvg[avg dot]{\pos+.5*\dx,\oldH}
        \node[avg text] at (\pos+0.5*\dx, \oldH+.1*\dx) {$u_\idx^{n}$};

        \DrawTick[newcolor]{\pos-\dt,0};
        \draw[newcolor] (\pos-\dt,0) -- ++(0, \newH) -- +(\dx,0);%
        \DrawAvg[new avg dot]{\pos+.5*\dx-\dt,\newH}
        \node[new avg text] at (\pos+0.5*\dx-\dt, \newH+.1*\dx) {$u_\idx^{n+1}$};
    }

    \draw (2*\dx,0) -- +(0,\hR);
    \DrawTick[newcolor]{2*\dx-\dt,0};
    \draw[newcolor] (2*\dx-\dt,\hRn) -- +(0, -\hRn);%

    \draw[<-] (-\dt, \hM+.3*\dx) -- (0, \hM+.3*\dx) node[midway, above] {$a\Delta t$};
\end{tikzpicture}
\end{document}
